(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime,a=({filter:e,onFilterChange:a})=>(0,t.jsxs)("div",{className:"filter-bar",children:[(0,t.jsx)("label",{children:"Context:"}),(0,t.jsxs)("select",{value:e,onChange:e=>a(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"All"}),(0,t.jsx)("option",{value:"post",children:"Posts/Pages"}),(0,t.jsx)("option",{value:"meta",children:"Meta"}),(0,t.jsx)("option",{value:"option",children:"Options"})]})]}),r=({items:e,onReplace:a,replacedItems:r})=>(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Context"}),(0,t.jsx)("th",{children:"ID"}),(0,t.jsx)("th",{children:"Label"}),(0,t.jsx)("th",{children:"Term"}),(0,t.jsx)("th",{children:"View"}),(0,t.jsx)("th",{children:"Replace"})]})}),(0,t.jsx)("tbody",{children:e.map((e=>{const n=`${e.context}-${e.ID}-${e.term}`,c=r.has(n);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.context}),(0,t.jsx)("td",{children:e.ID}),(0,t.jsx)("td",{children:e.label}),(0,t.jsx)("td",{children:e.term}),(0,t.jsx)("td",{children:(0,t.jsx)("a",{href:`${e.view_url}${e.view_url.includes("?")?"&":"?"}rebrand_term=${encodeURIComponent(e.term)}`,target:"_blank",rel:"noopener noreferrer",children:"View"})}),(0,t.jsx)("td",{children:c?(0,t.jsx)("span",{style:{display:"inline-block",background:"#d4edda",color:"#155724",padding:"4px 8px",borderRadius:"4px",fontSize:"0.9em"},children:"Replaced"}):(0,t.jsx)("button",{type:"button",onClick:()=>a(e),children:"Replace"})})]},`${e.context}-${e.ID}-${e.term}`)}))})]}),n=({page:e,pages:a,onPageChange:r})=>(0,t.jsx)("div",{className:"pagination",children:Array.from({length:a},((a,n)=>(0,t.jsx)("button",{disabled:n+1===e,onClick:()=>r(n+1),children:n+1},n)))}),c=()=>{const[c,s]=(0,e.useState)({terms:[],matches:[]}),[l,d]=(0,e.useState)("all"),[i,o]=(0,e.useState)(1),[h,x]=(0,e.useState)(""),[m,j]=(0,e.useState)(""),[p,u]=(0,e.useState)(new Set),b=()=>fetch(`${RebrandTrackerData.ajax_url}?action=rebrand_tracker_get_data&nonce=${RebrandTrackerData.nonce}`).then((e=>e.json())).then((e=>{e.success&&(s(e.data),e.data.terms&&e.data.terms.length>0&&x(e.data.terms[0]))}));(0,e.useEffect)(b,[]),(0,e.useEffect)((()=>{const e=localStorage.getItem("rebrand_replaceTerm");e&&j(e)}),[]),(0,e.useEffect)((()=>{localStorage.setItem("rebrand_replaceTerm",m)}),[m]);const g=c.matches.filter((e=>"all"===l||e.context===l)),R=Math.ceil(g.length/20),f=g.slice(20*(i-1),20*i);return(0,t.jsxs)(e.Fragment,{children:[(0,t.jsxs)("div",{className:"search-replace",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search term",value:h,onChange:e=>x(e.target.value)}),(0,t.jsx)("input",{type:"text",placeholder:"Replace term",value:m,onChange:e=>j(e.target.value)}),(0,t.jsx)("button",{onClick:()=>{if(!h.trim())return;const e=[h.trim()];fetch(RebrandTrackerData.ajax_url,{method:"POST",body:new URLSearchParams({action:"rebrand_tracker_set_terms",nonce:RebrandTrackerData.nonce,terms:JSON.stringify(e)})}).then((e=>e.json())).then((e=>{e.success&&(o(1),b())}))},children:"Search"})]}),(0,t.jsx)("h1",{children:"Content Rebrand Tracker"}),(0,t.jsx)(a,{filter:l,onFilterChange:e=>{d(e),o(1)}}),(0,t.jsx)(r,{items:f,onReplace:e=>{m.trim()?fetch(RebrandTrackerData.ajax_url,{method:"POST",body:new URLSearchParams({action:"rebrand_tracker_replace_item",nonce:RebrandTrackerData.nonce,context:e.context,id:e.ID,term:e.term,replace:m.trim()})}).then((e=>e.json())).then((t=>{t.success?(j(""),u((t=>{const a=new Set(t);return a.add(`${e.context}-${e.ID}-${e.term}`),a}))):alert(t.data)})):alert("Please enter a Replace term.")},replacedItems:p}),(0,t.jsx)(n,{page:i,pages:R,onPageChange:o})]})};(0,e.render)((0,t.jsx)(c,{}),document.getElementById("rebrand-tracker-app"))})();