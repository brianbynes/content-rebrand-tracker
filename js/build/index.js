(()=>{"use strict";const e=window.wp.element,t=window.ReactJSXRuntime,r=({filter:e,onFilterChange:r})=>(0,t.jsxs)("div",{className:"filter-bar",children:[(0,t.jsx)("label",{children:"Context:"}),(0,t.jsxs)("select",{value:e,onChange:e=>r(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"All"}),(0,t.jsx)("option",{value:"post",children:"Posts/Pages"}),(0,t.jsx)("option",{value:"meta",children:"Meta"}),(0,t.jsx)("option",{value:"option",children:"Options"})]})]}),a=({items:e,onReplace:r,replacedItems:a,replaceTerm:n})=>(0,t.jsxs)("table",{className:"table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Context"}),(0,t.jsx)("th",{children:"ID"}),(0,t.jsx)("th",{children:"Author"}),(0,t.jsx)("th",{children:"Label"}),(0,t.jsx)("th",{children:"Term"}),(0,t.jsx)("th",{children:"Instances"}),(0,t.jsx)("th",{children:"View"}),(0,t.jsx)("th",{children:"Replace"})]})}),(0,t.jsx)("tbody",{children:e.map((e=>{const l=`${e.context}-${e.ID}-${e.term}`,s=a.has(l);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:e.context}),(0,t.jsx)("td",{children:e.ID}),(0,t.jsx)("td",{children:e.author||""}),(0,t.jsx)("td",{children:e.label}),(0,t.jsx)("td",{children:e.term}),(0,t.jsx)("td",{children:e.instances||0}),(0,t.jsx)("td",{children:(0,t.jsx)("a",{href:`${e.view_url}${e.view_url.includes("?")?"&":"?"}rebrand_term=${encodeURIComponent(e.term)}`,target:"_blank",rel:"noopener noreferrer",children:"View"})}),(0,t.jsx)("td",{children:s?(0,t.jsx)("span",{style:{display:"inline-block",background:"#d4edda",color:"#155724",padding:"4px 8px",borderRadius:"4px",fontSize:"0.9em"},children:"Replaced"}):n.trim()?(0,t.jsx)("button",{type:"button",onClick:()=>r(e),children:"Replace"}):null})]},`${e.context}-${e.ID}-${e.term}`)}))})]}),n=({page:e,pages:r,onPageChange:a})=>(0,t.jsx)("div",{className:"pagination",children:Array.from({length:r},((r,n)=>(0,t.jsx)("button",{disabled:n+1===e,onClick:()=>a(n+1),children:n+1},n)))}),l=()=>{const[l,s]=(0,e.useState)({terms:[],matches:[]}),[c,o]=(0,e.useState)("all"),[d,i]=(0,e.useState)(1),[m,h]=(0,e.useState)(""),[x,p]=(0,e.useState)(""),[u,b]=(0,e.useState)(new Set),j=()=>fetch(`${RebrandTrackerData.ajax_url}?action=rebrand_tracker_get_data&nonce=${RebrandTrackerData.nonce}`).then((e=>e.json())).then((e=>{e.success&&(s(e.data),e.data.terms&&e.data.terms.length>0&&h(e.data.terms[0]))}));(0,e.useEffect)(j,[]),(0,e.useEffect)((()=>{const e=localStorage.getItem("rebrand_replaceTerm");e&&p(e)}),[]),(0,e.useEffect)((()=>{localStorage.setItem("rebrand_replaceTerm",x)}),[x]),(0,e.useEffect)((()=>{const e=localStorage.getItem("rebrand_replacedItems");e&&b(new Set(JSON.parse(e)))}),[]),(0,e.useEffect)((()=>{localStorage.setItem("rebrand_replacedItems",JSON.stringify(Array.from(u)))}),[u]);const g=l.matches.filter((e=>"all"===c||e.context===c)),y=Math.ceil(g.length/20),f=g.slice(20*(d-1),20*d);return(0,t.jsxs)(e.Fragment,{children:[(0,t.jsxs)("div",{className:"search-replace",children:[(0,t.jsx)("input",{type:"text",placeholder:"Search term",value:m,onChange:e=>h(e.target.value)}),(0,t.jsx)("input",{type:"text",placeholder:"Replace term",value:x,onChange:e=>p(e.target.value)}),(0,t.jsx)("button",{onClick:()=>{if(!m.trim())return;const e=[m.trim()];fetch(RebrandTrackerData.ajax_url,{method:"POST",body:new URLSearchParams({action:"rebrand_tracker_set_terms",nonce:RebrandTrackerData.nonce,terms:JSON.stringify(e)})}).then((e=>e.json())).then((e=>{e.success&&(i(1),j())}))},children:"Search"}),(0,t.jsx)("button",{type:"button",onClick:()=>{const e=document.querySelector('button[type="button"]');e.textContent,e.textContent="Clearing...",e.disabled=!0,localStorage.removeItem("rebrand_replaceTerm"),localStorage.removeItem("rebrand_replacedItems"),p(""),b(new Set),fetch(RebrandTrackerData.ajax_url,{method:"POST",body:new URLSearchParams({action:"clear_plugin_memory",nonce:RebrandTrackerData.nonce})}).then((e=>e.json())).then((e=>{if(e.success){const e=document.createElement("div");e.innerHTML='<span style="font-size:18px">âœ“</span> Memory cleared successfully!',e.style.cssText="position:fixed; top:50px; left:50%; transform:translateX(-50%) scale(0.9); opacity:0; background:#4CAF50; color:white; padding:12px 24px; border-radius:4px; z-index:10000; box-shadow:0 3px 12px rgba(0,0,0,0.3); font-weight:bold; font-size:15px; display:flex; align-items:center; gap:8px; border-left:5px solid #2E7D32;",document.body.appendChild(e),setTimeout((()=>{e.style.transition="transform 0.3s ease, opacity 0.3s ease",e.style.transform="translateX(-50%) scale(1)",e.style.opacity="1"}),10);const t=document.querySelector(".table");t&&(t.style.transition="background-color 0.5s ease",t.style.backgroundColor="#e8f5e9",setTimeout((()=>{t.style.backgroundColor=""}),1e3)),setTimeout((()=>{e.style.transform="translateX(-50%) scale(0.9)",e.style.opacity="0",setTimeout((()=>e.remove()),300)}),3500),j()}else alert("Failed to clear memory: "+(e.data||"Unknown error"));const t=document.querySelector('button[type="button"]');t.textContent="Clear All Memory",t.disabled=!1})).catch((e=>{console.error("Error clearing memory:",e),alert("Error clearing memory. Please check console.");const t=document.querySelector('button[type="button"]');t.textContent="Clear All Memory",t.disabled=!1}))},children:"Clear All Memory"})]}),(0,t.jsx)("h1",{children:"Content Rebrand Tracker"}),(0,t.jsx)(r,{filter:c,onFilterChange:e=>{o(e),i(1)}}),(0,t.jsx)(a,{items:f,onReplace:e=>{x.trim()?fetch(RebrandTrackerData.ajax_url,{method:"POST",body:new URLSearchParams({action:"rebrand_tracker_replace_item",nonce:RebrandTrackerData.nonce,context:e.context,id:e.ID,term:e.term,replace:x.trim()})}).then((e=>e.json())).then((t=>{t.success?b((t=>{const r=new Set(t);return r.add(`${e.context}-${e.ID}-${e.term}`),r})):alert(t.data)})):alert("Please enter a Replace term.")},replacedItems:u,replaceTerm:x}),(0,t.jsx)(n,{page:d,pages:y,onPageChange:i})]})};(0,e.render)((0,t.jsx)(l,{}),document.getElementById("rebrand-tracker-app"))})();